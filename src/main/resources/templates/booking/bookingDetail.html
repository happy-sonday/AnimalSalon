<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>예약하기</title>
<link rel="stylesheet" th:href="@{/static/datepicker/jquery-ui.css}">
</head>
<body>
	<!-- Header 들어올 예정 -->
	<div class="header">
			Header 내용 추가 (bookingMenu.html의 Header와 동일)
	</div>
	
	<!-- 메뉴선택 -->
<div>
	<div style="float: left; width: 500px;">
		<img width="100" height="100" style="float: left;" name="메뉴이미지">
		<span th:text="${menu.mName}"></span>
		<hr/>
		
		<!-- 메뉴옵션 -->
		<select th:if="${not #lists.isEmpty(menuOptions)}" id="optionList" name="optionList" onchange="change_sum_price(this);">
			<option value="x" disabled="disabled" selected="selected">옵션을 선택해주세요.</option>
			<option th:each="option : ${menuOptions}"
					th:value="|${option.oTime}:${option.oPrice}|"
					th:text="${option.oName}">
			</option>
		</select>
	
		<br/>
		<span>금액</span>
		<input type="hidden" th:value="${menu.mPrice}" id="defaultPrice">
		<span th:text="${menu.mPrice}" th:value="${menu.mPrice}" id="sumPrice" ></span>
					
		<br/>
		<span>소요시간</span>
		<input type="hidden" th:value="${menu.mTime}" id="defaultBeautyTime">
		<span th:text="${menu.mTime}" th:value="${menu.mTime}" id="sumBeautyTime"></span>
		
			<script type="text/javascript">
				var change_sum_price = function (selected_option){
					// 금액 및 소요시간 초기화
					$('#sumPrice').text($('#defaultPrice').val());
					$('#sumBeautyTime').text($('#defaultBeautyTime').val());
					
					var mo_index = selected_option.selectedIndex; // 인덱스
					var mo_text = selected_option.options[mo_index].text; // 해당 인덱스의 text
					var mo_value = selected_option.options[mo_index].value; // 해당 인덱스의 value
					var mo_beauty_time = mo_value.substring(0, mo_value.lastIndexOf(":"))*1; // value의 앞 (beauty_time)
					var mo_price = mo_value.substring(mo_value.lastIndexOf(":")+1)*1; // value의 뒤 (price)
					
					console.log("선택한 인덱스 번호 : " + mo_index);
					console.log("text : " + mo_text);
					console.log("value : " + mo_value);
					console.log("beauty_time : " + mo_beauty_time);
					console.log("price : " + mo_price);
					
					let sum_priceT = $('#sumPrice').text()*1;
// 					let sum_priceV = $('#sumPrice').val()*1;
					let sum_beauty_timeT = $('#sumBeautyTime').text()*1;
// 					let sum_beauty_timeV = $('#sumBeautyTime').val()*1;
					console.log("테스트 텍스트" + sum_priceT)
// 					console.log("테스트 벨류" + sum_priceV)
					console.log("테스트 텍스트" + sum_beauty_timeT)
// 					console.log("테스트 벨류" + sum_beauty_timeV)
					
					var price = sum_priceT + mo_price;
					var btime = sum_beauty_timeT + mo_beauty_time;
					
					$('#sumPrice').text(price);
					$('#sumBeautyTime').text(btime);
					
// 					$('#sumPrice').val(price);
// 					$('#sumBeautyTime').val(btime);
				};

			</script>
		
		<!-- 날짜선택 -->
		<br/><br/><br/>
		<div>
		날짜선택
		<br/>
			<input type="text" id="bookingDate" name="bookingDate">
		</div>
	</div>
	
	<!-- 디자이너 및 시간 선택 -->
	<div style="float: left;">
		<div th:each="dList : ${designers}">
			<img width="75px" height="75px" name="디자이너사진" />
			<span th:text="${dList.dName}"></span>&nbsp;&nbsp;&nbsp;
			<span th:text="${dList.dInfo}"></span>&nbsp;&nbsp;&nbsp; <br/>
			<!-- 테스트용 --><span th:text="${dList.dDayOff}"></span>
			<!-- 테스트용 --><span th:text="${todaysDay}"></span>
				<button th:if="${#strings.equals(todaysDay,dList.dDayOff)}">정기휴무</button>
				<button th:unless="${#strings.equals(todaysDay,dList.dDayOff)}">디자이너예약가능시간</button>
				<button th:if="${#strings.equals(todaysDay,dList.dDayOff)}">정기휴무</button>
				<button th:unless="${#strings.equals(todaysDay,dList.dDayOff)}">디자이너예약가능시간</button>
			<br/>
		</div>
	</div>
</div>

	
	<!-- 기타 세부사항 (상품고시, 거래정보, 예약환불규정은 버튼 클릭 시 펼쳐지게)-->
	<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><hr>
	
	
				
	<div align="center">
		<label>상품부가설명</label>
		<span th:text="${menu.mInfo}" ></span>
		<ul>
			<li>상품고시▼</li>
		<span>상품고시정보 들어갈 예정</span>
			<li>거래정보▼</li>
		<span>거래정보 들어갈 예정</span>
			<li>예약환불규정▼</li>
		<span>예약환불규정 들어갈 예정</span>
		</ul>
		<a th:href="@{/pay}">예약하기</a>
	</div>
	
<script th:src="@{/static/js/jquery-3.5.1.min.js}" type="text/javascript"></script>
<script th:src="@{/static/datepicker/jquery-ui.js}" type="text/javascript"></script>
<script th:src="@{/static/js/booking/booking.js}" type="text/javascript"></script>
<script type="text/javascript">

$(document).ready(function(){
	
	var getDate = $('#bookingDate').datepicker('getDate');

	
});

$('#bookingDate').click(function(){
	var getDate = $.datepicker.formatDate('yy-mm-dd(DD)', $('#bookingDate').datepicker('getDate'));
	console.log(getDate);
});

</script>
</body>
</html>